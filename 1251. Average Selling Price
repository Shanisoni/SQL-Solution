# Write your MySQL query statement below
SELECT A1.product_id , ROUND(COALESCE(SUM(A1.price * A2.units) / SUM(A2.units) , 0), 2) AS average_price
FROM Prices AS A1
LEFT JOIN UnitsSold AS A2
ON A1.product_id = A2.product_id
AND purchase_date BETWEEN start_date AND end_date
GROUP BY A1.product_id


ğŸ… Golden SQL Points from "Average Selling Price"
ğŸ”¸ 1. Join with Date Range Matching

... JOIN UnitsSold u
ON p.product_id = u.product_id
AND u.purchase_date BETWEEN p.start_date AND p.end_date

âœ… Match rows based on date â€” this is a powerful real-world technique.

    ğŸ”¥ Use Case: Find valid prices, discounts, contracts, or bookings based on dates.

ğŸ”¸ 2. Calculate Revenue Using Aggregates

SUM(u.units * p.price)

âœ… Multiply related columns across tables and then aggregate.

    ğŸ”¥ Use Case: Calculating totals like revenue, cost, or weighted averages.

ğŸ”¸ 3. Handling NULL with IFNULL() or COALESCE()

ROUND(IFNULL(sum(price Ã— units) / sum(units), 0), 2)

âœ… Prevents errors like division by NULL and ensures missing data returns 0.

    ğŸ’¡ IFNULL() is MySQL-specific, COALESCE() is portable.

ğŸ”¸ 4. Use ROUND(..., 2) to Format Result

ROUND(..., 2)

âœ… Required when the result must be in 2 decimal places, such as money, average price, percentages, etc.

    ğŸª™ Always round in financial calculations for accuracy & presentation.

ğŸ”¸ 5. LEFT JOIN to Handle â€œNo Dataâ€ Cases

LEFT JOIN UnitsSold ...

âœ… Includes products even if they had no sales (important to avoid missing rows).

    ğŸ§  Think: "Include all from Prices, even if no match in UnitsSold."

ğŸ”¸ 6. Group By to Aggregate Per Product

GROUP BY p.product_id

âœ… Always needed when using SUM(), AVG(), etc. per group.

    ğŸ¯ Think: â€œOne result per product/customer/date/group.â€

ğŸ”¸ 7. Modular Thinking for Weighted Average

AVG = total_value / total_weight

âœ… In this case:

    Value = price * units

    Weight = units

    ğŸ“Š This is weighted average, not simple average.

ğŸ“Œ TL;DR Summary for Future Reference
Concept	SQL Feature Used	Why Important
Join on Date Range	BETWEEN start AND end	Time-sensitive data joins
Revenue Calculation	SUM(price Ã— units)	Real-world business logic
Handle NULL	IFNULL() or COALESCE()	Safe math & cleaner output
Format Output	ROUND(..., 2)	Clean display of decimals
Include All Products	LEFT JOIN	Avoid missing data in result
Per Group Calculation	GROUP BY product_id	Needed for aggregation
Weighted Average	sum(weight Ã— value)/sum(wt)	Interview favorite
